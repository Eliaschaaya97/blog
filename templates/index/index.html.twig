{% extends 'base.html.twig' %}

{% block title %}Home{% endblock %}

{% block body %}

        <div class="white-navbar container-fluid">
            {% include 'elements/header-v2.html.twig'%}
        </div>
<script>
    const blogs = {{ blogs|json_encode|raw }};
    let currentIndex = 0;
    const itemsPerPage = 10;
    let currentCategory = 'all'; // Track the current category

    function filterBlogs(category, reset = true) {
        const blogContent = document.getElementById('blog-content');
        const buttons = document.querySelectorAll('.button-container button');

        // Update the active button
        buttons.forEach(button => {
            button.classList.remove('button-active');
        });
        // Add active class to the clicked button
        const activeButton = Array.from(buttons).find(button => button.innerText.toLowerCase() === category.toLowerCase());
        if (activeButton) {
            activeButton.classList.add('button-active');
        }

        if (reset) {
            currentIndex = 0;
            blogContent.innerHTML = '';
            currentCategory = category; // Update the current category
        }

        // Filter blogs based on the selected category
        const filteredBlogs = currentCategory === 'all'
            ? blogs
            : blogs.filter(blog => blog.categoryid.toLowerCase() === currentCategory.toLowerCase());

        const nextBlogs = filteredBlogs.slice(currentIndex, currentIndex + itemsPerPage);
        currentIndex += itemsPerPage;

        nextBlogs.forEach(blog => {
            const blogElement = document.createElement('div');
            blogElement.classList.add('blog-post');
            
            blogElement.onclick = () => {
                window.location.href = `/blog/${blog.id}`;
            };

            blogElement.innerHTML = `
                <img class="img-blog" src="${blog.image}" alt="${blog.title}"/>
                <div class="body-blog">
                    <span class="blog-category">${blog.categoryid}</span>
                    <h2 class="blog-title">${blog.title}</h2>
                    <span class="blog-created">${blog.created}</span>
                </div>
            `;
            blogContent.appendChild(blogElement);
        });

        const showMoreButton = document.getElementById('show-more-button');
        if (currentIndex >= filteredBlogs.length) {
            showMoreButton.style.display = 'none';
        } else {
            showMoreButton.style.display = 'block';
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        filterBlogs('all');
    });
</script>


<div class="container">
    <header>
        <h1 class='suyoolheadertitle'>Suyool's Blog</h1>
    </header>

    <div class="button-container"> 
        <button onclick="filterBlogs('all', true)">All</button>
        <button onclick="filterBlogs('politics', true)">politics</button>
        <button onclick="filterBlogs('sports', true)">sports</button>
        <button onclick="filterBlogs('Technology', true)">Technology</button>
        <button onclick="filterBlogs('Business', true)">Business</button>
    </div>
    

    <main>
        <div id="blog-content"></div>
        <button id="show-more-button" class="show-more-button mt-5" style="display: none;" onclick="filterBlogs(currentCategory, false)">Show More</button>
    </main>
</div>
   {% include 'elements/needHelp.twig' %}
   {% include 'elements/footer.html.twig' %}
{% endblock %}
